subsystem = NFIRAOS
component = envCtrl

publish {

  telemetry = [
    {
      name = "logging"
      description = "logging settings XXX"
      archive = false
      attributes = [
        {
          name = logToFile
          description = "sensor values logged to file enabled"
          type = boolean
        }
        {
          name = filename
          description = "path and file name of the engineering log file"
          type = string
        }
      ]
    }

    {
      name = "sensors"
      description = "temperature sensor values"
      archive = true
      attributes = [
        {
          name = temp_ngsWfs
          description = "NGS WFS temperature"
          type = number
          units = degC
        }
        {
          name = temp_lgsWfs
          description = "LGS WFS temperature"
          type = number
          units = degC
        }
        {
          name = temp_morTwfs
          description = "MOR TWFS temperature"
          type = number
          units = degC
        }
        {
          name = temp_nacq
          description = "NACQ camera temperature"
          type = number
          units = degC
        }
        {
          name = temp_nhrwfs
          description = "NHRWFS temperature"
          type = number
          units = degC
        }
        {
          name = temp_dm0
          description = "DM0 temperature"
          type = number
          units = degC
        }
        {
          name = temp_dm11
          description = "DM11 temperature"
          type = number
          units = degC
        }
        {
          name = temp_ndme
          description = "NDME crate temperatures"
          type = array
          minItems = 7
          items = {
            type = number
            units = degC
          }
        }
        {
          name = temp_ntts
          description = "NTTS temperature"
          type = number
          units = degC
        }
        {
          name = temp_nttsElec
          description = "NTTS electronics temperature"
          type = number
          units = degC
        }
        {
          name = temp_actuator
          description = "motor & piezo actuator temperatures"
          type = array
          minItems = 30
          items = {
            type = number
            units = degC
          }
        }

        // TODO: add other sensor items: humidity, pressure, oxygen, ...

      ]
    }
  ]


  events = [
    {
      name = state
      description = "overall state"
      enum = [idle, busy, error]
    }
    {
      name = initialized
      description = "initialized state"
      type = boolean
    }
    {
      name = health
      description = "health state"
      enum = [good, ill, bad, unknown]
    }
    {
      name = heartbeat
      description = "software heartbeat"
      type = integer
    }
  ]

  eventStreams = [
    {
      name = "logging"
      description = "logging settings"
      archive = false
      attributes = [
        {
          name = logToFile
          description = "sensor values logged to file enabled"
          type = boolean
        }
        {
          name = filename
          description = "path and file name of the engineering log file"
          type = string
        }
      ]
    }
    {
      name = "sensors"
      description = "temperature sensor values"
      archive = true
      attributes = [
        {
          name = temp_ngsWfs
          description = "NGS WFS temperature"
          type = number
          units = degC
        }
        {
          name = temp_lgsWfs
          description = "LGS WFS temperature"
          type = number
          units = degC
        }
        {
          name = temp_morTwfs
          description = "MOR TWFS temperature"
          type = number
          units = degC
        }
        {
          name = temp_nacq
          description = "NACQ camera temperature"
          type = number
          units = degC
        }
        {
          name = temp_nhrwfs
          description = "NHRWFS temperature"
          type = number
          units = degC
        }
        {
          name = temp_dm0
          description = "DM0 temperature"
          type = number
          units = degC
        }
        {
          name = temp_dm11
          description = "DM11 temperature"
          type = number
          units = degC
        }
        {
          name = temp_ndme
          description = "NDME crate temperatures"
          type = array
          minItems = 7
          items = {
            type = number
            units = degC
          }
        }
        {
          name = temp_ntts
          description = "NTTS temperature"
          type = number
          units = degC
        }
        {
          name = temp_nttsElec
          description = "NTTS electronics temperature"
          type = number
          units = degC
        }
        {
          name = temp_actuator
          description = "motor & piezo actuator temperatures"
          type = array
          minItems = 30
          items = {
            type = number
            units = degC
          }
        }

      ]
    }
  ]



  health = [
    {
      name = "health"
      description = "Health state"
      valueType {
        enum = [good, ill, bad, unknown]
        default = good
      }
      rate = 0
      maxRate = 100
      archive = false
    }
    {
      name = "heartbeat"
      description = "Regular heartbeat message"
      valueType {
        type = integer
        default = 0
      }
      rate = 0
      maxRate = 10
      archive = false
    }

  ]

  alarms = [
    {
      name = "maxTemperature"
      description = "Warns when temperature too high (dummy)"
      severity = major
      archive = true
    }
    {
      name = "minTemperature"
      description = "Warns when temperature too low (dummy)"
      severity = major
      archive = true
    }

  ]


}